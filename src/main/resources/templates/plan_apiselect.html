<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org">
<head>

  <div th:replace="common/common_head :: common_resource"></div>
  <!-- text fonts -->
  <link rel="stylesheet" href="assets/css/fonts.googleapis.com.css" />

  <!-- ace styles -->
  <link rel="stylesheet" href="assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />

  <!--[if lte IE 9]>
  <link rel="stylesheet" href="assets/css/ace-part2.min.css" class="ace-main-stylesheet" />
  <![endif]-->
  <link rel="stylesheet" href="assets/css/ace-skins.min.css" />
  <link rel="stylesheet" href="assets/css/ace-rtl.min.css" />

  <!--[if lte IE 9]>
    <link rel="stylesheet" href="assets/css/ace-ie.min.css" />
  <![endif]-->
  <script src="assets/js/ace-extra.min.js"></script>

  <!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

  <!--[if lte IE 8]>
  <script src="assets/js/html5shiv.min.js"></script>
  <script src="assets/js/respond.min.js"></script>
  <![endif]-->
</head>
<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">

<div th:replace="common/main_header :: main_header"></div>

<div th:replace="common/main_sidebar :: main_sidebar"></div>

<!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        接口列表数据
        <small>洋葱接口</small>
      </h1>
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li><a href="#">Tables</a></li>
        <li class="active">Data tables</li>
      </ol>
    </section>

    <!-- Main content -->
    <section class="content">

      <!--表格内容数据 -->
      <div class="page-content">

        <div class="row">
          <div class="col-xs-12">
            <div class="row">
              <div class="col-xs-12">
                <form id="mytable" name="mytable" action="/planedit2" method="post">
                  <input type="hidden" name="planId" th:value="${planId}">
                <div class="table-header">

                 <table  width="100%"><tr>
                     <td width="20%">选择计划集合需要的接口</td>
                   <td width="50%"></td>
                   <td width="15%"><a href="javascript:history.go(-1);" ><font color="white">返回</font></a> </td>
                   <td width="15%"><a href="javascript:document.mytable.submit();" ><font color="white">下一步</font></a></td>
                 </tr></table>
                </div>

                <!-- div.table-responsive -->

                <!-- div.dataTables_borderWrap  真正的表格数据-->
                <div>

                  <table id="dynamic-table" class="table table-striped table-bordered table-hover"  width="100%">
                    <thead>
                    <tr>

                      <th class="center">
                        <label class="pos-rel">
                          <input type="checkbox" class="ace" />
                          <span class="lbl"></span>
                        </label>
                      </th>
                      <th>id</th>
                      <th>name</th>
                      <th>method</th>
                      <th>path</th>
                      <th>label</th>
                      <!--<th>remarks</th>-->

                    </tr>
                    </thead>

                    <tbody>

                    <tr  th:each=" myapi:${apilist}">

                      <td class="center">
                        <label class="pos-rel">
                          <input type="checkbox" class="ace" name="api_id"  th:id="${myapi.id}" th:value="${myapi.id}"
                                 th:checked="${ids.contains(myapi.id.toString())}"  />

                          <span class="lbl"></span>
                        </label>
                      </td>

                      <td th:text="${myapi.id}"></td>
                      <td th:text="${myapi.name}"></td>
                      <td th:text="${myapi.method}"></td>
                      <td th:text="${myapi.path}">/</td>
                      <td th:text="${myapi.label}"></td>
                      <!--<td th:text="${myapi.remarks}"></td>-->

                    </tr>

                    </tbody>
                  </table>
                </div>
                </form>
              </div>
            </div>

            <!-- PAGE CONTENT ENDS -->
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div>
      <!-- /.page-content -->

    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->
  <div th:replace="common/common_footer :: common_footer"></div>
  <!-- /.control-sidebar -->
  <!-- Add the sidebar's background. This div must be placed
       immediately after the control sidebar -->
  <div class="control-sidebar-bg"></div>
</div>
<!-- ./wrapper -->

<!--[if !IE]> -->
<script src="assets/js/jquery-2.1.4.min.js"></script>
<!-- <![endif]-->
<!--[if IE]>
<script src="assets/js/jquery-1.11.3.min.js"></script>
<![endif]-->
<script type="text/javascript">
  if('ontouchstart' in document.documentElement) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
</script>
<script src="assets/js/bootstrap.min.js"></script>
<!-- page specific plugin scripts -->
<script src="assets/js/jquery.dataTables.min.js"></script>
<script src="assets/js/jquery.dataTables.bootstrap.min.js"></script>
<script src="assets/js/dataTables.buttons.min.js"></script>
<script src="assets/js/buttons.flash.min.js"></script>
<script src="assets/js/buttons.html5.min.js"></script>
<script src="assets/js/buttons.print.min.js"></script>
<script src="assets/js/buttons.colVis.min.js"></script>
<script src="assets/js/dataTables.select.min.js"></script>



<!-- ace scripts -->
<script src="assets/js/ace-elements.min.js"></script>
<script src="assets/js/ace.min.js"></script>

<!-- inline scripts related to this page -->
<script type="text/javascript">
//   var ids=[];
//
//   // var ids=[111,12];
//   // var checkedIds;
//   Array.prototype.indexOf = function(val) {
//     for (var i = 0; i < this.length; i++) {
//       if (this[i] == val) return i;
//     }
//     return -1;
//   };
//   Array.prototype.remove = function(val) {
//     var index = this.indexOf(val);
//     if (index > -1) {
//       this.splice(index, 1);
//     }
//   };
//
//   function test2(id){
//     td=document.getElementById(id);
//     if(td.checked==false&&ids.indexOf(id)==-1) ids.push(id);
//     else ids.remove(id);
// alert(ids.toString());
//     }

  // function test(){
  //   // $("[name='api_id']").each(function(){
  //   //   //alert(this.type+'---'+this.value);
  //   //   var th_checked = this.checked;
  //   //   if(th_checked&&ids.indexOf(this.value)==-1) ids.push(this.value);
  //   //   else {ids.remove(this.value);}
  //   // });
  //   alert(checkedIds);
  // }
  //
  //
  // function  updateCheckBoxIds() {
  //   var oneches=document.getElementsByName("api_id");
  //   for(var i=0;i<oneches.length;i++){
  //     if(oneches[i].checked==true){
  //       //避免重复添加（若存在元素时，不添加）
  //       if(!contains(checkedIds,oneches[i].value)){
  //         checkedIds+=oneches[i].value+",";
  //       }
  //     }
  //     if(oneches[i].checked==false){
  //       //取消复选框时 含有该id时将id从全局变量中去除
  //       if(contains(checkedIds,oneches[i].value)){
  //         checkedIds=checkedIds.replace((oneches[i].value+","),"");
  //       }
  //     }
  //   }
  // }


  jQuery(function($) {
    //initiate dataTables plugin
    var myTable =
            $('#dynamic-table')
                    .DataTable( {
                      bAutoWidth: true,
                      paging: false,
                      scrollY: 800,
                      scrollX: 600,
                      ordering: true,
                       autoFill: true,
                      colReorder: true,
                      //"aaSorting": [],
                      //"bProcessing": true,
                      //"bServerSide": true,
                      //"sScrollY": "200px",
                      //"bPaginate": false,
                      //"sScrollX": "100%",
                      // "sScrollXInner": "120%",
                      // "bScrollCollapse": true,
                      //Note: if you are applying horizontal scrolling (sScrollX) on a ".table-bordered"
                      //you may want to wrap the table inside a "div.dataTables_borderWrap" element
                      // "iDisplayLength": 50,
                      select: {
                        style: 'multi'
                      }
                    } );



    $.fn.dataTable.Buttons.defaults.dom.container.className = 'dt-buttons btn-overlap btn-group btn-overlap';


    myTable.buttons().container().appendTo( $('.tableTools-container') );

    //style the message box
    var defaultCopyAction = myTable.button(1).action();
    myTable.button(1).action(function (e, dt, button, config) {
      defaultCopyAction(e, dt, button, config);
      $('.dt-button-info').addClass('gritter-item-wrapper gritter-info gritter-center white');
    });


    var defaultColvisAction = myTable.button(0).action();
    myTable.button(0).action(function (e, dt, button, config) {

      defaultColvisAction(e, dt, button, config);


      if($('.dt-button-collection > .dropdown-menu').length == 0) {
        $('.dt-button-collection')
                .wrapInner('<ul class="dropdown-menu dropdown-light dropdown-caret dropdown-caret" />')
                .find('a').attr('href', '#').wrap("<li />")
      }
      $('.dt-button-collection').appendTo('.tableTools-container .dt-buttons')
    });

    ////

    setTimeout(function() {
      $($('.tableTools-container')).find('a.dt-button').each(function() {
        var div = $(this).find(' > div').first();
        if(div.length == 1) div.tooltip({container: 'body', title: div.parent().text()});
        else $(this).tooltip({container: 'body', title: $(this).text()});
      });
    }, 500);





    myTable.on( 'select', function ( e, dt, type, index ) {
      if ( type === 'row' ) {
        $( myTable.row( index ).node() ).find('input:checkbox').prop('checked', true);
      }
    } );
    myTable.on( 'deselect', function ( e, dt, type, index ) {
      if ( type === 'row' ) {
        $( myTable.row( index ).node() ).find('input:checkbox').prop('checked', false);
      }
    } );




    /////////////////////////////////
    //table checkboxes
    // $('th input[type=checkbox], td input[type=checkbox]').prop('checked', false);

    //select/deselect all rows according to table header checkbox
    $('#dynamic-table > thead > tr > th input[type=checkbox], #dynamic-table_wrapper input[type=checkbox]').eq(0).on('click', function(){
      var th_checked = this.checked;//checkbox inside "TH" table header

      $('#dynamic-table').find('tbody > tr').each(function(){
        var row = this;
        if(th_checked) myTable.row(row).select();
        else  myTable.row(row).deselect();
      });
    });

    //select/deselect a row when the checkbox is checked/unchecked
    $('#dynamic-table').on('click', 'td input[type=checkbox]' , function(){
      var row = $(this).closest('tr').get(0);
      if(this.checked) myTable.row(row).deselect();
      else myTable.row(row).select();
    });



    $(document).on('click', '#dynamic-table .dropdown-toggle', function(e) {
      e.stopImmediatePropagation();
      e.stopPropagation();
      e.preventDefault();
    });






    /********************************/
    //add tooltip for small view action buttons in dropdown menu
    $('[data-rel="tooltip"]').tooltip({placement: tooltip_placement});

    //tooltip placement on right or left
    function tooltip_placement(context, source) {
      var $source = $(source);
        var $parent = $source.closest('table');
      var off1 = $parent.offset();
      var w1 = $parent.width();

      var off2 = $source.offset();
      //var w2 = $source.width();

      if( parseInt(off2.left) < parseInt(off1.left) + parseInt(w1 / 2) ) return 'right';
      return 'left';
    }

  })
</script>


</body>
</html>
